<p id="notice"><%= notice %></p>

<h1>Appointments</h1>

<table class="table table-striped">
  <thead>
    <tr><input type="text" name="query" class="search" placeholder= "Doctor Name and City Name" class="form-control-dark w-100" />
  </tr>
    <tr>
      <th>Doctor First Name</th>
      <th>Doctor Last Name</th>
      <th>Doctor Email</th>
      <th>City</th>
      <th>Appointment date</th>
      <th>Patient Photos</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @appointments.each do |appointment| %>
      <tr>
        <% @doctors.each do |doctor| %>
          <%if appointment.doctor_id == doctor.id %>
            <td><%= doctor.first_name %></td>
            <td><%= doctor.last_name %></td>
            <td><%= doctor.email %></td>
            <td><%= doctor.city_name %></td>
          <td><%= appointment.appointment_date.strftime("%FT%T") %></td>
          <td>
            <% appointment.photos.each do |photo| %>    
            <%= image_tag photo.thumb.url, class: "mt-4" %>    
            <%end%>

          </td>
          <td><%= link_to 'Show', appointment %></td>
          <td><%= link_to 'Edit', edit_appointment_path(appointment) %></td>
          <td><%= link_to 'Destroy', appointment, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        <%end%>
      <%end%>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New Appointment', new_appointment_path %>
